<!DOCTYPE html>  
<html lang="ar">  
<head>  
    <meta charset="UTF-8">  
    <meta name="viewport" content="width=device-width, initial-scale=1.0">  
    <title>مشاركة المناوبة عبر واتساب</title>  
    <style>  
        body {  
            font-family: 'Arial', sans-serif;  
            direction: rtl;  
            padding: 20px;  
        }  
        select, button {  
            width: 100%;  
            padding: 10px;  
            margin-bottom: 10px;  
            font-size: 16px;  
            border-radius: 5px;  
            border: 1px solid #ccc;  
        }  
        button {  
            background-color: #25D366;  
            color: white;  
            border: none;  
        }  
        button:hover {  
            background-color: #20b857;  
        }  
    </style>  
</head>  
<body>  

    <h2>إعداد رسالة المناوبة</h2>  
    <div>  
        <label>مناوبة الفسحة والمصلى (اضغط Ctrl أو Cmd لاختيار متعدد):</label>  
        <select id="firstDuty" multiple size="5">  
            <option value="أحمد طوهري">أحمد طوهري</option>  
            <option value="خالد المالكي">خالد المالكي</option>  
            <option value="رجائي آدم">رجائي آدم</option>  
            <option value="عبدالقادر طلحة">عبدالقادر طلحة</option>  
            <option value="عبدالله العمري">عبدالله العمري</option>  
            <option value="عوض الأسمري">عوض الأسمري</option>  
            <option value="محمد الحسني">محمد الحسني</option>  
            <option value="محمد السفياني">محمد السفياني</option>  
            <option value="محمد الغامدي">محمد الغامدي</option>  
            <option value="يوسف الدليجان">يوسف الدليجان</option>  
            <option value="بندر الحجيلان">بندر الحجيلان</option>  
            <option value="خالد الفهيد">خالد الفهيد</option>  
            <option value="سليمان المغشي">سليمان المغشي</option>  
            <option value="مشاري الملاح">مشاري الملاح</option>  
            <option value="ناصر العجاجي">ناصر العجاجي</option>  
            <option value="سالم القحطاني">سالم القحطاني</option>  
            <option value="فهد الدريهم">فهد الدريهم</option>  
            <option value="محمد القحطاني">محمد القحطاني</option>  
            <option value="محمد السبت">محمد السبت</option>  
            <option value="جهاد الحفير">جهاد الحفير</option>  
        </select>  
    </div>  

    <div>  
        <label>مناوبة نهاية الدوام:</label>  
        <select id="secondDuty">  
            <option value="">اختر اسم</option>  
            <option value="أحمد طوهري">أحمد طوهري</option>  
            <option value="خالد المالكي">خالد المالكي</option>  
            <option value="رجائي آدم">رجائي آدم</option>  
            <option value="عبدالقادر طلحة">عبدالقادر طلحة</option>  
            <option value="عبدالله العمري">عبدالله العمري</option>  
            <option value="عوض الأسمري">عوض الأسمري</option>  
            <option value="محمد الحسني">محمد الحسني</option>  
            <option value="محمد السفياني">محمد السفياني</option>  
            <option value="محمد الغامدي">محمد الغامدي</option>  
            <option value="يوسف الدليجان">يوسف الدليجان</option>  
            <option value="بندر الحجيلان">بندر الحجيلان</option>  
            <option value="خالد الفهيد">خالد الفهيد</option>  
            <option value="سليمان المغشي">سليمان المغشي</option>  
            <option value="مشاري الملاح">مشاري الملاح</option>  
            <option value="ناصر العجاجي">ناصر العجاجي</option>  
            <option value="سالم القحطاني">سالم القحطاني</option>  
            <option value="فهد الدريهم">فهد الدريهم</option>  
            <option value="محمد القحطاني">محمد القحطاني</option>  
            <option value="محمد السبت">محمد السبت</option>  
            <option value="جهاد الحفير">جهاد الحفير</option>  
        </select>  
    </div>  

    <button onclick="shareOnWhatsApp()">مشاركة عبر واتساب</button>  

    <script>  
        function convertToHijri(gDate) {  
            const M = 30.6001;  
            const Y_ = gDate.getFullYear();  
            const M_ = gDate.getMonth() + 1;  
            const D_ = gDate.getDate();  

            const JDN = 367 * Y_ - Math.floor((7 * (Y_ + Math.floor((M_ + 9) / 12))) / 4) + Math.floor((275 * M_) / 9) + D_ + 1721013.5;  

            const epochastro = 1948084;  
            const epochcivil = 1948085;  

            const shift1 = epochcivil - epochastro;  
            const z = JDN - epochastro;  
            const cyc = Math.floor(z / 10631);  
            const j = z - 10631 * cyc;  
            const y = Math.floor((j - shift1) / 354.366);  
            const years = 30 * cyc + y;  
            const month = Math.min(12, Math.floor((j - shift1 - 354.366 * y) / 29.5) + 1);  
            const day = j - shift1 - Math.floor(354.366 * y) - Math.floor(29.5 * (month - 1)) + 1;  

            return `${Math.floor(day)}-${month}-${years}`;  
        }  

        function arabicNumbers(input) {  
            const arabicDigits = ['٠', '١', '٢', '٣', '٤', '٥', '٦', '٧', '٨', '٩'];  
            return input.toString().replace(/\d/g, (d) => arabicDigits[d]);  
        }  

        function shareOnWhatsApp() {  
            const firstDuty = Array.from(document.getElementById('firstDuty').selectedOptions)  
                .map((opt, index) => `${index + 1}️⃣ ${opt.value}`).join('\n');  
            const secondDuty = document.getElementById('secondDuty').value;  
            const today = new Date();  
            const dayName = today.toLocaleDateString('ar-EG', { weekday: 'long' });  
            const gregorianDate = today.toLocaleDateString('en-US', { year: 'numeric', month: 'numeric', day: 'numeric' });  

            const hijriDate = convertToHijri(today);  
            const hijriDateArabic = hijriDate.split('-').map(arabicNumbers).join('-');  

            const message = `السلام عليكم ورحمة الله..\n\n🔴 (( مناوبة هذا اليوم )) 🔴\n\n✨ ${dayName}\n\n📅 ${gregorianDate}\n🕌 ${hijriDateArabic}\n\n🟡 ( مناوبة الفسحة والمصلى ) 🟡\n\n${firstDuty}\n\n📌 ( مناوبة نهاية الدوام ) 📌\n\n${secondDuty}\n\n📝 *آمل من جميع الزملاء الالتزام بالمناوبة من بداية اليوم الدراسي ( الطابور الصباحي - الفسحة - الصلاة ).*\n\n📝 *الالتزام بمناوبة نهاية الدوام وتسجيل الطلاب المتأخرين في الانصراف في السجل الخاص بذلك.*`;  

            // Use the appropriate URL based on the device type  
            const isMobile = /iPhone|iPad|iPod|Android/i.test(navigator.userAgent);  
            const whatsappUrl = isMobile   
                ? `whatsapp://send?text=${encodeURIComponent(message)}`  
                : `https://api.whatsapp.com/send?text=${encodeURIComponent(message)}`;  

            window.open(whatsappUrl, '_blank');  
        }  
    </script>  

</body>  
</html>